stages:
  - test
  - build

frontend_tests:
  stage: test
  script:
    - cd frontend
    - npm install
    - cd ..
    - npm install
    - npx playwright install
    - npx playwright test tests/frontend/**
  rules:
    - changes:
      - "frontend/**"

frontend_build:
  stage: build
  script:
    - cd frontend
    - npm install
    - npm run build
  rules:
    - changes:
      - "frontend/**"

backend_tests:
  stage: test
  script:
    - cd backend
    - npm install
    - cd ..
    - npm install
    - npx playwright install
    - npx playwright test tests/backend/**
  rules:
    - changes:
      - "backend/**"

backend_build:
  stage: test
  script:
    - cd backend
    - npm install
    - npm run build
  rules:
    - changes:
      - "backend/**"